\section{palm4MSA algorithm}
\label{sec:app:palm4msa}
\addVE{Pour que $S_0=\lambda \rmI$ soit Ã  gauche, inverser l'ordre du produit (actuellement $S_{Q-1}...S_2 S_1$).}

\begin{algorithm}
	\caption{palm4MSA algorithm}
	\label{algo:palm4msa}
	\begin{algorithmic}[1]
		
		
		\REQUIRE The matrix to factorize $\rmU \in \R^{\nclusters \times \datadim}$, the desired number of factors $\nfactors$, the constraint sets $\mathcal{E}_q$ , $q\in \intint{\nfactors}$ and a stopping criterion (e.g., here, a number of iterations $N_{iter}$ ).
		
%		\ENSURE $\{\rmS_1 \dots \rmS_{\nfactors}\}|\rmS_q \in \mathcal{E}_q$ such that $\prod_{q\in\intint{\nfactors}}\rmS_q \approx \rmU$
		
		\FOR {$i = \in\intint{N_{iter}}$}
		\FOR {$q = 1$ to $\nfactors$}
		\STATE  $\rmL_q \leftarrow \prod_{l=q+1}^{\nfactors} \rmS_{l}^{(i)}$
		\COMMENT{in $\mathcal{O}\left (1\right )$}
		\STATE  $\rmR_q \leftarrow \prod_{l=0}^{q-1} \rmS_{l}^{(i+1)}$
		\COMMENT{in $\mathcal{O}\left (1\right )$}
%		\STATE Choose $c > (\lambda^{(i)})^2 ||\rmR_q||_2^2 ||\rmL_q||_2^2$
		\STATE Choose $c > ||\rmR_q||_2^2 ||\rmL_q||_2^2$
		\COMMENT{$\mathcal{O}\left (TODO\right )$}
		\STATE $\rmD \leftarrow \rmS_q^i - \frac{1}{c} \rmL_q^T(\rmL_q \rmS_q^i \rmR_q - \rmU)\rmR_q^T$
%		\STATE $\rmD \leftarrow \rmS_q^i - \frac{1}{c} \lambda^{(i)} \rmL_q^T(\lambda^{(i)} \rmL_q \rmS_q^i \rmR_q - \rmU)\rmR_q^T$
		\STATE $\rmS^{(i+1)}_q \leftarrow P_{\mathcal{E}_q}(\rmD)$
		\ENDFOR
		\STATE $\hat \rmU := \prod_{j=1}^{\nfactors} \rmS_q^{(i+1)}$
		\STATE $\lambda^{(i+1)} \leftarrow \frac{Trace(\rmU^T\hat\rmU)}{Trace(\hat\rmU^T\hat\rmU)}$
		\STATE $\rmS_0 \leftarrow \lambda^{(i+1)} \rmI$
		\ENDFOR
		
		\ENSURE $\left \lbrace \rmS_q : \rmS_q \in \mathcal{E}_q\right \rbrace_{q\in\intint{\nfactors}}$ such that $\prod_{q\in\intint{\nfactors}}\rmS_q \approx \rmU$
		
	\end{algorithmic}
\end{algorithm}

